# HTTP、HTTPS协议

## 一、HTTP协议
	HTTP的全称是Hyper Text Transfer Protocol，中文名叫作超文本传输协议。HTTP协议是用于从网络传输超文本数据到本地浏览器的传送协议，它能保证高效而准确地传送超文本文档。HTTP由万维网协会（World Wide Web Consortium）和Internet工作小组IETF（Internet Engineering Task Force）共同合作制定的规范，目前广泛使用的是HTTP1.1版本

### 1.1 报文结构
	HTTP请求报文：
		请求报文由请求行、请求头部、空行和请求数据4个部分组成
			请求行：请求方法、URL、协议版本号、回车符
			请求头部：设置Http请求的各种参数
			空行：必须的空行，表示请求头部的结束
			请求正文：携带上传的数据，主要是POST请求
		
		
	HTTP响应报文：
		响应报文由状态行、响应报头、空行、响应正文
			状态行：协议版本、状态码、状态码描述
			响应头部：说明客户端使用的一些附加信息，如date、content-type
			响应正文：返回的数据
		
### 1.2 HTTP 请求/响应的步骤
	a. 客户端连接到Web服务器
		一个HTTP客户端，通常是浏览器，与Web服务器的HTTP端口（默认为80）建立一个TCP套接字连接
		
	b. 发送HTTP请求
		通过TCP套接字，客户端向Web服务器发送一个文本的请求报文
		一个请求报文由请求行、请求头部、空行和请求数据4部分组成
		
	c. 服务器接受请求并返回HTTP响应
		Web服务器解析请求，定位请求资源。服务器将资源复本写到TCP套接字，由客户端读取
		一个响应由状态行、响应头部、空行和响应数据4部分组成
		
	d. 释放连接TCP连接
		若connection 模式为close，则服务器主动关闭TCP连接，客户端被动关闭连接，释放TCP连接
		若connection 模式为keepalive，则该连接会保持一段时间，在该时间内可以继续接收请求
		
	e. 客户端浏览器解析HTML内容
		客户端浏览器首先解析状态行，查看表明请求是否成功的状态代码
		然后解析每一个响应头，响应头告知以下为若干字节的HTML文档和文档的字符集
		客户端浏览器读取响应数据HTML，根据HTML的语法对其进行格式化，并在浏览器窗口中显示
		
### 1.3 常见的HTTP相应状态码
	200：请求被正常处理
	204：请求被受理但没有资源可以返回
	301：永久性重定向
	302：临时重定向
	303：与302状态码有相似功能，只是它希望客户端在请求一个URI的时候，能通过GET方法重定向到另一个URI上
	307：临时重定向，与302类似，只是强制要求使用POST方法
	400：请求报文语法有误，服务器无法识别
	401：请求需要认证
	403：请求的对应资源禁止被访问
	404：服务器无法找到对应资源
	500：服务器内部错误
	503：服务器正忙
	
### 1.4 浏览器输入www.baidu.com后，网络过程
	事件顺序：
		a. 浏览器获取输入的域名www.baidu.com
		
		b. 浏览器向DNS请求解析www.baidu.com的IP地址
		
		c. 域名系统DNS解析出百度服务器的IP地址
		
		d. 浏览器与该服务器建立TCP连接(默认端口号80)
		
		e. 浏览器发出HTTP请求，请求百度首页
		
		f. 服务器通过HTTP响应把首页文件发送给浏览器
		
		g. TCP连接释放
		
		h. 浏览器将首页文件进行解析，并将Web页显示给用户
		
### 1.5 http1.0与http1.1的区别
	a. HTTP 1.0中浏览器与服务器只保持短暂的连接，浏览器的每次请求都与服务器建立一个TCP连接，服务器完成请求处理后立即断开TCP连接，服务器不跟踪每个客户也不记录过去的请求
	
	b. http1.1提供永久性连接（即1.0使用非持久连接，HTTP1.0没有host的字段)
	
	c. HTTP 1.1中增加Host请求头字段后，实现了在一台WEB服务器上可以在同一个IP地址和端口号上使用不同的主机名来创建多个虚拟WEB站点
	
	d. http1.1提供身份认证（HTTP1.1提供一个基于口令的基本认证方式）
	
## 二、HTTPS协议
	是以安全为目标的HTTP通道，也就是安全版的HTTP，通过在HTTP下加入SSL层来提供安全传输支持。Https的主要作用包括：建立信息安全的通道，保证数据的安全传输以及确认网站的真实性
	
### 2.1 SSL
	SSL一种是为网络通信提供安全以及数据完整性的安全协议，SSL位于TCP与各应用层之间，是操作系统对外提供的API，SSL3.0版本以后被称为TSL。主要通过身份验证和数据加密保证网络通信的安全和数据的完整性
	
### 2.2 客户端校验CA证书
	CA证书中的Hash值，是用证书的私钥进行加密后的值（证书的私钥不在 CA 证书中）
	
	然后客户端得到证书后，利用证书中的公钥去解密该Hash值，得到Hash-a
	
	然后再利用证书内的签名Hash算法去生成一个Hash-b
	
	最后比较Hash-a和Hash-b这两个的值
		a. 如果相等，那么证明了该证书是对的，服务端是可以被信任的
		b. 如果不相等，那么就说明该证书是错误的，可能被篡改了，浏览器会给出相关提示，无法建立起HTTPS连接
		
	除此之外，还会校验CA证书的有效时间和域名匹配等
	
### 2.3 SSL握手建立过程
	HTTPS加密原理的过程中把对称加密和非对称加密都利用了起来
	即利用了非对称加密安全性高的特点，又利用了对称加密速度快，效率高的好处
	
	假设用浏览器打开网页www.baidu.com,这时，浏览器就是客户端A，百度的服务器就是服务器B：
		a. 首先，客户端A访问服务器B，这时候客户端A会生成一个随机数1，把随机数1、自己支持的SSL版本号以及加密算法等这些信息告诉服务器B

		b. 服务器B知道这些信息后，然后确认一下双方的加密算法，然后服务端也生成一个随机数B，并将随机数B和CA颁发给自己的证书一同返回给客户端A 

		c. 客户端A得到CA证书后，会去校验该CA证书的有效性，校验通过后，客户端生成一个随机数3，然后用证书中的公钥加密随机数3并传输给服务端B

		d. 服务端B得到加密后的随机数3，然后利用私钥进行解密，得到真正的随机数3

		e. 最后，客户端A和服务端B都有随机数1、2、3，然后双方利用这三个随机数生成一个对话密钥,之后传输内容就是利用对话密钥来进行加解密了,这时就是利用了对称加密，一般用的都是AES算法
		
		f. 客户端A通知服务端B，指明后面的通讯用对称密钥来完成，同时通知服务器B和自己的握手过程结束
		
		g. 服务端B通知客户端A，指明后面的通讯用对称密钥来完成，同时通知客户端A和自己的握手过程结束
		
		h. SSL的握手部分结束，SSL安全通道的数据通讯开始，客户端A和服务器B开始使用相同的对话密钥进行数据通讯
	
### 2.4 HTTPS真的安全吗？
	HTTPS并不是真正的安全，如果在浏览器地址栏只输入网址，不输入协议，浏览器就会默认填充http://，会有被劫持的风险
	
### 2.5 Http和Https的区别
	a. HTTPS需要到CA申请证书，HTTP不需要
	
	b. HTTPS密文传输，HTTP明文传输
	
	c. 连接方式不同，默认端口也不一样。HTTPS默认使用443端口，HTTP使用80端口
	
	d. HTTPS=HTTP+加密+认证+完整性保护，较HTTP安全
	
## 三、其他

### 3.1 GET和POST
	a. Http报文层面：GET将请求信息放在URL中，POST放在报文体中
	
	b. 数据库层面：GET符合幂等性和安全性，POST不符合
	

## update continue ......